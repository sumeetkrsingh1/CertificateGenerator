<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Certificate Generator - Odoo Style</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <!-- Navigation Bar -->
    <nav class="navbar">
      <div class="nav-logo">ğŸ“œ Certificate Generator</div>
      <div class="nav-links">
        <a href="#">Home</a>
        <a href="#">Certificates</a>
        <a href="#">Settings</a>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
      <div class="sidebar">
        <h3>ğŸ“‹ Instructions</h3>
        <ul class="steps">
          <li><strong>Step 1:</strong> Upload CSV or Excel file</li>
          <li><strong>Step 2:</strong> File must have columns: First Name, Middle Name, Last Name, Email, Certificate sent</li>
          <li><strong>Step 3:</strong> Click "Generate & Send Certificates"</li>
          <li><strong>Step 4:</strong> Certificates will be generated and emailed to students</li>
          <li><strong>Step 5:</strong> Download or view certificates from the results</li>
        </ul>
      </div>

      <div class="main-panel">
        <div class="card">
          <div class="card-header">
            <h2>ğŸš€ Generate Certificates</h2>
            <p class="subtitle">Upload a CSV/Excel file with participant data</p>
          </div>

          <div class="card-body">
            <!-- File Upload Section -->
            <div class="form-group">
              <label for="fileInput" class="label-text">ğŸ“ Select CSV or Excel File:</label>
              <div class="file-input-wrapper">
                <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" class="file-input" />
                <span id="fileName" class="file-name">No file selected</span>
              </div>
            </div>

            <!-- Template Info -->
            <div class="template-info">
              <p><strong>âœ… Expected File Format:</strong></p>
              <table class="template-table">
                <tr>
                  <th>First Name</th>
                  <th>Middle Name</th>
                  <th>Last Name</th>
                  <th>Email</th>
                  <th>Certificate sent</th>
                </tr>
                <tr>
                  <td>John</td>
                  <td>Kumar</td>
                  <td>Doe</td>
                  <td>john@example.com</td>
                  <td>No</td>
                </tr>
                <tr>
                  <td>Jane</td>
                  <td>Singh</td>
                  <td>Smith</td>
                  <td>jane@example.com</td>
                  <td>No</td>
                </tr>
              </table>
            </div>

            <!-- Submit Button -->
            <div class="form-group">
              <button id="submitBtn" class="btn btn-primary btn-lg" disabled>
                <span id="btnText">ğŸ“ Generate & Send Certificates</span>
                <span id="btnSpinner" class="spinner" style="display: none;"></span>
              </button>
            </div>

            <!-- Progress Section -->
            <div id="progressSection" class="progress-section" style="display: none;">
              <div class="progress-container">
                <div class="progress-bar">
                  <div id="progressFill" class="progress-fill"></div>
                </div>
                <p id="progressText" class="progress-text">Processing...</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="card" style="display: none; margin-top: 20px;">
          <div class="card-header">
            <h3>âœ… Results</h3>
          </div>
          <div class="card-body">
            <div id="successMessage" class="alert alert-success" style="display: none;"></div>
            <div id="errorMessage" class="alert alert-error" style="display: none;"></div>
            
            <div id="certificatesList" class="certificates-list"></div>

            <div class="result-stats">
              <p><strong>Total Students:</strong> <span id="totalStudents">0</span></p>
              <p><strong>Certificates Generated:</strong> <span id="certificatesGenerated">0</span></p>
              <p><strong>Emails Sent:</strong> <span id="emailsSent">0</span></p>
            </div>

            <button id="resetBtn" class="btn btn-secondary">ğŸ”„ Process Another File</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
